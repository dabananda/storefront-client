<div class="py-8">
  <header class="mb-8 text-center">
    <h1 class="text-3xl font-bold text-gray-900 tracking-tight sm:text-4xl">
      Latest Products
    </h1>
    <p class="mt-2 text-lg text-gray-600 max-w-2xl mx-auto">
      Discover our curated collection of premium items.
    </p>
  </header>

  <div class="max-w-md mx-auto mb-10 relative">
    <input 
      type="text" 
      [(ngModel)]="searchQuery" 
      (keyup.enter)="onSearch()"
      placeholder="Search products..." 
      class="w-full px-4 py-3 rounded-full border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none pl-12 pr-28 shadow-sm transition-all"
    >
    
    <svg class="w-5 h-5 text-gray-400 absolute left-4 top-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
    </svg>

    @if (searchQuery()) {
      <button 
        (click)="clearSearch()"
        class="absolute right-24 top-3.5 text-gray-400 hover:text-gray-600 transition-colors cursor-pointer"
        aria-label="Clear search"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
          <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
        </svg>
      </button>
    }

    <button 
      (click)="onSearch()"
      class="absolute right-2 top-2 bg-indigo-600 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-indigo-700 transition-colors cursor-pointer"
    >
      Search
    </button>
  </div>

  <div class="flex flex-wrap justify-center gap-3 mb-10">
    <button (click)="setCategory('all')"
      class="px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 border cursor-pointer" [class]="selectedCategory() === 'all' 
        ? 'bg-indigo-600 text-white border-indigo-600' 
        : 'bg-white text-gray-700 border-gray-200 hover:bg-gray-50'">
      All
    </button>

    @for (cat of categories(); track cat) {
    <button (click)="setCategory(cat)"
      class="px-4 py-2 rounded-full text-sm font-medium capitalize transition-colors duration-200 border cursor-pointer"
      [class]="selectedCategory() === cat 
          ? 'bg-indigo-600 text-white border-indigo-600' 
          : 'bg-white text-gray-700 border-gray-200 hover:bg-gray-50'">
      {{ cat }}
    </button>
    }
  </div>

  @if (isLoading()) {
  <div class="flex justify-center items-center py-20">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
  </div>
  }

  @if (errorMessage()) {
  <div class="text-red-500 text-center mb-8">{{ errorMessage() }}</div>
  }

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 xl:gap-8 mb-12">
    @for (product of products(); track product.id) {
    <app-product-card [product]="product" />
    } @empty {
    @if (!isLoading() && !errorMessage()) {
    <div class="col-span-full text-center py-12">
      <p class="text-gray-500 text-lg">No products found matching your search.</p>
    </div>
    }
    }
  </div>

  @if (!isLoading() && products().length > 0) {
  <div class="flex justify-center items-center space-x-4">
    <button (click)="prevPage()" [disabled]="currentPage() === 0"
      class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer">
      Previous
    </button>

    <span class="text-sm text-gray-700">
      Page <span class="font-medium">{{ currentPage() + 1 }}</span> of <span class="font-medium">{{ totalPages()
        }}</span>
    </span>

    <button (click)="nextPage()" [disabled]="currentPage() >= totalPages() - 1"
      class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer">
      Next
    </button>
  </div>
  }
</div>